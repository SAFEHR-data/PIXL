version: "3.8"

services:

  queue:
    container_name: pixl-queue
    image: apachepulsar/pulsar:2.10.2
    deploy:
      resources:
        limits:
          cpus: '1'
          memory: 4G
    env_file:
      - .env.test
    ports:
      - "${PIXL_PULSAR_HTTP_PORT}:8080"
      - "${PIXL_PULSAR_BINARY_PORT}:6650"
    entrypoint: ["bin/pulsar", "standalone"]
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://queue:8080/admin/v2/brokers/health"]
      start_period: 160s
      interval: 60s
      timeout: 60s
      retries: 2
